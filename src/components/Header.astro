---
import { getRelativeLocaleUrl } from 'astro:i18n';
const { lang } = Astro.props;
const themes = [
  'light',
  'dark',
  'cupcake',
  'bumblebee',
  'emerald',
  'corporate',
  'synthwave',
  'retro',
  'cyberpunk',
  'valentine',
  'halloween',
  'garden',
  'forest',
  'aqua',
  'lofi',
  'pastel',
  'fantasy',
  'wireframe',
  'black',
  'luxury',
  'dracula',
  'cmyk',
  'autumn',
  'business',
  'acid',
  'lemonade',
  'night',
  'coffee',
  'winter',
  'dim',
  'nord',
  'sunset',
  'caramellatte',
  'abyss',
  'silk',
];
const targetLang = lang === 'fr' ? 'en' : 'fr';
const switchUrl = getRelativeLocaleUrl(targetLang);
---

<div class="navbar bg-base-100 border-b border-base-200 sticky top-0 z-30 px-4">
  <div class="flex-none lg:hidden">
    <label for="my-drawer" class="btn btn-square btn-ghost">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        class="inline-block w-6 h-6 stroke-current"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"></path></svg
      >
    </label>
  </div>

  <div class="flex-1"></div>

  <div class="flex-none gap-4">
    <a href={switchUrl} class="btn btn-ghost btn-sm text-lg font-bold">
      {targetLang.toUpperCase()}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="ml-1 opacity-70"
        ><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path
          d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
        ></path></svg
      >
    </a>

    <div class="dropdown dropdown-end">
      <div tabindex="0" role="button" class="btn btn-ghost btn-sm text-lg font-bold gap-2">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="opacity-70"
        >
          <circle cx="13.5" cy="6.5" r=".5"></circle>
          <circle cx="17.5" cy="10.5" r=".5"></circle>
          <circle cx="8.5" cy="7.5" r=".5"></circle>
          <circle cx="6.5" cy="12.5" r=".5"></circle>
          <path
            d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.744 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"
          ></path>
        </svg>

        <span class="hidden md:inline">Theme</span>

        <svg
          width="10px"
          height="10px"
          class="opacity-50"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 2048 2048"
          ><path d="M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"></path></svg
        >
      </div>

      <ul
        tabindex="0"
        class="dropdown-content z-1 bg-base-200 p-2 shadow-2xl rounded-box w-52 max-h-96 overflow-y-auto mt-4"
      >
        {
          themes.map((theme) => (
            <li>
              <button
                class="theme-btn btn btn-ghost btn-sm btn-block justify-start mb-1 capitalize font-medium"
                data-theme-value={theme}
                data-theme={theme}
              >
                {theme}
              </button>
            </li>
          ))
        }
      </ul>
    </div>
  </div>
</div>

<script>
  const buttons = document.querySelectorAll('.theme-btn');
  buttons.forEach((btn) => {
    btn.addEventListener('click', () => {
      const newTheme = btn.getAttribute('data-theme-value');

      if (newTheme) {
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
      }
    });
  });
</script>
